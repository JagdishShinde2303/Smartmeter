[env:esp32dev]
platform = espressif32
board = esp32doit-devkit-v1
framework = arduino

# UART Upload Speed
upload_speed = 921600
monitor_speed = 115200

# Libraries
lib_deps =
    PubSubClient          ; MQTT client
    ModbusMaster          ; Modbus protocol
    ArduinoJson           ; JSON serialization
    WiFi                  ; WiFi connectivity (built-in)

# Build flags
build_flags =
    -DCORE_DEBUG_LEVEL=5
    -DMQTT_KEEPALIVE=60
    -DMQTT_SOCKET_TIMEOUT=60

# Monitor & Debug
monitor_filters = esp32_exception_decoder
debug_tool = esp-prog
debug_protocol = jtag

# OTA Settings
upload_protocol = espota
upload_port = 192.168.1.100
upload_flags =
    --auth=otapassword

[env:esp32-production]
platform = espressif32
board = esp32doit-devkit-v1
framework = arduino
upload_speed = 921600
monitor_speed = 115200

lib_deps =
    PubSubClient
    ModbusMaster
    ArduinoJson

build_flags =
    -DCORE_DEBUG_LEVEL=0
    -DMQTT_KEEPALIVE=60
    -DOTA_ENABLED=1
    -O2

; Development environment with debug
[env:esp32-debug]
platform = espressif32
board = esp32doit-devkit-v1
framework = arduino
upload_speed = 115200
monitor_speed = 115200
lib_deps =
    PubSubClient
    ModbusMaster
    ArduinoJson
build_flags =
    -DCORE_DEBUG_LEVEL=5
    -DDEBUG_MODE=1
    -O0

; Memory optimization
[env:esp32-minimal]
platform = espressif32
board = esp32doit-devkit-v1
framework = arduino
upload_speed = 921600
build_flags =
    -DCORE_DEBUG_LEVEL=1
    -Os
    -ffunction-sections
    -fdata-sections
lib_deps =
    PubSubClient
    ModbusMaster
    ArduinoJson
